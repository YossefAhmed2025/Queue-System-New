<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>شاشة مكتب 1</title>
<style>
  *{box-sizing:border-box;margin:0;padding:0}
  body,html{
    height:100%;
    font-family:'Segoe UI', Tahoma, sans-serif; /* Keep Segoe UI, it's clean */
    color:#fff;
    overflow: hidden;
  }
  .bg {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    z-index: -1;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #111; /* Fallback background */
  }
  .bg img {
    width: 100%;
    height: 100%;
    object-fit: cover; /* Cover the entire area */
    opacity: 0.8; /* More subtle background */
    /* Removed: filter: grayscale(50%); */
  }
  /* Dark overlay to make text pop */
  .bg::after {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(0, 0, 0, 0.1); /* Darker overlay */
    z-index: 0;
  }
  .wrap {
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 24px;
    text-align: center;
    position: relative; /* Ensure content is above overlay */
    z-index: 1;
  }
  h1{
    font-size: 8vw; /* Responsive font size */
    font-weight: 900; /* Extra bold */
    margin-bottom: 20px; /* More space */
    margin-top: 50px; /* Added to lower the element */
    color:#fff;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.5); /* Subtle shadow */
  }
  .current{
    font-size: 25vw; /* Even larger for impact */
    font-weight:900;
    color:#22c55e; /* Vibrant green */
    text-shadow: 4px 4px 8px rgba(0,0,0,0.7); /* Stronger shadow for number */
    margin:10px 0 24px;
    transition: transform 0.2s ease-in-out;
  }
  @keyframes flash {
    0% { transform: scale(1); color: #22c55e; }
    50% { transform: scale(1.2); color: #f59e0b; /* Orange flash */ }
    100% { transform: scale(1); color: #22c55e; }
  }
  .flash {
    animation: flash 0.6s ease; /* Slower, more noticeable flash */
  }
</style>
</head>
<body>
  <div class="bg">
    <img src="Helwan National University.jpg" alt="background">
  </div>
  
  <div class="wrap">
    <h1 id="deskNumber">1</h1>
    <div id="current" class="current">0</div>
  </div>

<script>
const DESK_ID = '1';
const STATE_KEY = 'queue_system_state';

function loadState() {
    try {
        const state = JSON.parse(localStorage.getItem(STATE_KEY));
        return state || {};
    } catch {
        return {};
    }
}

function render() {
    const state = loadState();
    const deskState = state[DESK_ID] || { current: 0 };
    
    const currentEl = document.getElementById('current');
    const oldNumber = currentEl.textContent;
    const newNumber = deskState.current || 0;

    if (String(oldNumber) !== String(newNumber)) {
        currentEl.textContent = newNumber;
        currentEl.classList.remove('flash');
        void currentEl.offsetWidth; // Trigger reflow
        currentEl.classList.add('flash');
    }
}

window.addEventListener('storage', (e) => {
  if (e.key === STATE_KEY) {
    render();
  }
});

// Initial render
document.getElementById('deskNumber').textContent = DESK_ID;
render();
</script>
</body>
</html>
