<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>شاشة مكتب 4</title>
<style>
  *{box-sizing:border-box;margin:0;padding:0}
  body,html{
    height:100%;
    font-family:'Segoe UI', Tahoma, sans-serif;
    color:#fff;
    overflow: hidden;
  }
  .bg {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    z-index: -1;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #111;
  }
  .bg img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    opacity: 0.8;
  }
  .bg::after {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(0, 0, 0, 0.1);
    z-index: 0;
  }
  .wrap {
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 24px;
    text-align: center;
    position: relative;
    z-index: 1;
  }
  h1{
    font-size: 8vw;
    font-weight: 900;
    margin-bottom: 20px;
    margin-top: 50px;
    color:#fff;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
  }
  .current{
    font-size: 25vw;
    font-weight:900;
    color:#22c55e;
    text-shadow: 4px 4px 8px rgba(0,0,0,0.7);
    margin:10px 0 24px;
    transition: transform 0.2s ease-in-out;
  }
  @keyframes flash {
    0% { transform: scale(1); color: #22c55e; }
    50% { transform: scale(1.2); color: #f59e0b; }
    100% { transform: scale(1); color: #22c55e; }
  }
  .flash {
    animation: flash 0.6s ease;
  }
</style>
</head>
<body>
  <div class="bg">
    <img src="Helwan National University.jpg" alt="background">
  </div>
  
  <div class="wrap">
    <h1 id="deskNumber">4</h1>
    <div id="current" class="current">-</div>
  </div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

<script>
    const DESK_ID = '4';

    // Your web app's Firebase configuration
    const firebaseConfig = {
        apiKey: "AIzaSyDsNSCnJ5EUUd6TT7ZlM1yvBuDNkiZ8Si0",
        authDomain: "hnu-system.firebaseapp.com",
        databaseURL: "https://hnu-system-default-rtdb.firebaseio.com/",
        projectId: "hnu-system",
        storageBucket: "hnu-system.firebasestorage.app",
        messagingSenderId: "461347950072",
        appId: "1:461347950072:web:76966d73d3abdff7da9a0d",
        measurementId: "G-R6SEPHNG4W"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();
    const queueStateRef = database.ref('queueState/' + DESK_ID);

    const currentEl = document.getElementById('current');
    document.getElementById('deskNumber').textContent = `مكتب ${DESK_ID}`;

    // Listen for state changes from Firebase
    queueStateRef.on('value', (snapshot) => {
        const deskState = snapshot.val() || { current: '-' };
        const oldNumber = currentEl.textContent;
        const newNumber = deskState.current ?? '-';

        if (String(oldNumber) !== String(newNumber)) {
            currentEl.textContent = newNumber;
            currentEl.classList.remove('flash');
            void currentEl.offsetWidth; // Trigger reflow
            currentEl.classList.add('flash');
        }
    });
</script>
</body>
</html>